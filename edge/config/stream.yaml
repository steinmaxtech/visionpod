# =============================================================================
# PLATE RECOGNIZER STREAM CONFIGURATION
# =============================================================================
# Docs: https://docs.platerecognizer.com/stream/configuration/
#
# This file configures how Plate Recognizer watches your camera
# and where it sends detected plates.
#
# =============================================================================

# -----------------------------------------------------------------------------
# CAMERAS
# -----------------------------------------------------------------------------
# Add one entry per camera. Most sites have 1-2 cameras per gate.

cameras:
  - id: gate-camera-1
    name: Main Gate Camera
    
    # RTSP URL from your camera
    # Common formats:
    #   Hikvision:  rtsp://user:pass@IP:554/Streaming/Channels/101
    #   Dahua:      rtsp://user:pass@IP:554/cam/realmonitor?channel=1&subtype=0
    #   Amcrest:    rtsp://user:pass@IP:554/cam/realmonitor?channel=1&subtype=0
    #   UniFi:      rtsps://IP:7441/CAMERA_ID?enableSrtp
    #   Generic:    rtsp://user:pass@IP:554/stream1
    url: "${CAMERA_RTSP_URL}"
    
    # Frames per second to analyze (lower = less API cost, but might miss fast cars)
    # Recommended: 2-4 for gate entry, 1-2 for parking lots
    fps: 2
    
    # Minimum confidence score (0.0 - 1.0)
    # Higher = fewer false positives, but might miss hard-to-read plates
    mmc: 0.7
    
    # Region hints - helps accuracy
    # Options: us, eu, au, br, mx, in, sg, kr, etc.
    regions:
      - us
    
    # Detection zone (optional) - only detect plates in this area
    # Coordinates as percentage [x, y, width, height]
    # Useful to ignore parked cars, focus on entry lane
    # detection_zone: [0.2, 0.3, 0.6, 0.5]

# Uncomment to add a second camera
#  - id: gate-camera-2
#    name: Exit Camera
#    url: "${CAMERA_2_RTSP_URL}"
#    fps: 2
#    mmc: 0.7
#    regions:
#      - us

# -----------------------------------------------------------------------------
# WEBHOOK
# -----------------------------------------------------------------------------
# Where to send plate detections

webhook_targets:
  - url: "http://edge-agent:8080/webhook/plate"
    
    # Include image in webhook (needed for event thumbnails)
    image: true
    
    # Send webhook for all detections, not just new plates
    # Set to false to only send when plate changes
    send_all: true

# -----------------------------------------------------------------------------
# GENERAL SETTINGS
# -----------------------------------------------------------------------------

# API mode: "stream" uses your token, "sdk" uses license key for offline
# mode: stream

# Log level: DEBUG, INFO, WARNING, ERROR
# log_level: INFO

# Save images locally (in addition to webhook)
# save_images: false
# save_path: /user-data/images
